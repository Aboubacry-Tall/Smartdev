<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
        <record model="res.groups.privilege" id="res_groups_privilege_access_management">
            <field name="name">Access Management</field>
            <field name="sequence">10</field>
        </record>

        <record id="group_dg_read_all" model="res.groups">
            <field name="name">DG READ ALL</field>
            <field name="privilege_id" ref="res_groups_privilege_access_management"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
            <field name="comment">Accès en lecture globale (DG).</field>
        </record>

        <record id="group_audit" model="res.groups">
            <field name="name">AUDIT</field>
            <field name="privilege_id" ref="res_groups_privilege_access_management"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
            <field name="comment">Accès en lecture seule (audit) : CRM, Ventes, Comptabilité, Facturation, Abonnements, Projets, Tâches, Helpdesk, RH, Paie, Logs.</field>
        </record>

        <record id="group_pmo" model="res.groups">
            <field name="name">PMO</field>
            <field name="privilege_id" ref="res_groups_privilege_access_management"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
            <field name="comment">Projets/Tâches : lecture, création, modification (sans suppression). Feuilles de temps : lecture et validation. CRM, Helpdesk, Reporting : lecture seule.</field>
        </record>

        <record id="group_bd_manager" model="res.groups">
            <field name="name">BD MANAGER</field>
            <field name="privilege_id" ref="res_groups_privilege_access_management"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
            <field name="comment">CRM, Leads, Opportunités, Devis, Clients : lecture, création, modification (sans suppression). Produits, Abonnements, Reporting : lecture seule.</field>
        </record>

        <record id="group_siha_agent" model="res.groups">
            <field name="name">SI7A AGENT</field>
            <field name="privilege_id" ref="res_groups_privilege_access_management"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
            <field name="comment">Leads (assignés), Opportunités (assignées), Clients (lecture limitée), Commissions : lecture seule.</field>
        </record>

        <record id="group_df_manager" model="res.groups">
            <field name="name">DF MANAGER</field>
            <field name="privilege_id" ref="res_groups_privilege_access_management"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
            <field name="comment">Projets, Tâches, Produits, Roadmap (milestones) : lecture, création, modification (sans suppression). Helpdesk N3 : lecture seule.</field>
        </record>
    </data>

    <!-- Règles ir.rule : DG READ ALL et AUDIT peuvent voir TOUS les enregistrements (lecture seule) -->
    <data noupdate="1">
        <!-- Ventes / Devis -->
        <record id="sale_order_rule_dg_read_all" model="ir.rule">
            <field name="name">Devis / Commandes : tous (DG lecture seule)</field>
            <field name="model_id" ref="sale.model_sale_order"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="sale_order_line_rule_dg_read_all" model="ir.rule">
            <field name="name">Lignes de devis : tous (DG lecture seule)</field>
            <field name="model_id" ref="sale.model_sale_order_line"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- CRM -->
        <record id="crm_lead_rule_dg_read_all" model="ir.rule">
            <field name="name">CRM Leads : tous (DG lecture seule)</field>
            <field name="model_id" ref="crm.model_crm_lead"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Comptabilité / Facturation -->
        <record id="account_move_rule_dg_read_all" model="ir.rule">
            <field name="name">Écritures comptables : tous (DG lecture seule)</field>
            <field name="model_id" ref="account.model_account_move"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="account_move_line_rule_dg_read_all" model="ir.rule">
            <field name="name">Lignes comptables : tous (DG lecture seule)</field>
            <field name="model_id" ref="account.model_account_move_line"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Projets -->
        <record id="project_project_rule_dg_read_all" model="ir.rule">
            <field name="name">Projets : tous (DG lecture seule)</field>
            <field name="model_id" ref="project.model_project_project"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Tâches -->
        <record id="project_task_rule_dg_read_all" model="ir.rule">
            <field name="name">Tâches : tous (DG lecture seule)</field>
            <field name="model_id" ref="project.model_project_task"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Helpdesk -->
        <record id="helpdesk_ticket_rule_dg_read_all" model="ir.rule">
            <field name="name">Tickets Helpdesk : tous (DG lecture seule)</field>
            <field name="model_id" ref="helpdesk.model_helpdesk_ticket"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- RH -->
        <record id="hr_employee_rule_dg_read_all" model="ir.rule">
            <field name="name">Employés : tous (DG lecture seule)</field>
            <field name="model_id" ref="hr.model_hr_employee"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Paie -->
        <record id="hr_payslip_rule_dg_read_all" model="ir.rule">
            <field name="name">Bulletins de paie : tous (DG lecture seule)</field>
            <field name="model_id" ref="hr_payroll.model_hr_payslip"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="hr_payslip_run_rule_dg_read_all" model="ir.rule">
            <field name="name">Lots de paie : tous (DG lecture seule)</field>
            <field name="model_id" ref="hr_payroll.model_hr_payslip_run"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Website -->
        <record id="website_page_rule_dg_read_all" model="ir.rule">
            <field name="name">Pages web : tous (DG lecture seule)</field>
            <field name="model_id" ref="website.model_website_page"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Marketing -->
        <record id="marketing_campaign_rule_dg_read_all" model="ir.rule">
            <field name="name">Campagnes marketing : tous (DG lecture seule)</field>
            <field name="model_id" ref="marketing_automation.model_marketing_campaign"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="marketing_activity_rule_dg_read_all" model="ir.rule">
            <field name="name">Activités marketing : tous (DG lecture seule)</field>
            <field name="model_id" ref="marketing_automation.model_marketing_activity"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Logs (ir.logging) -->
        <record id="ir_logging_rule_dg_read_all" model="ir.rule">
            <field name="name">Logs : tous (DG / AUDIT lecture seule)</field>
            <field name="model_id" ref="base.model_ir_logging"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_dg_read_all')), (4, ref('access_management.group_audit'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- PMO : Projets et Tâches (lecture, création, modification, pas de suppression) -->
        <record id="project_project_rule_pmo" model="ir.rule">
            <field name="name">Projets : tous (PMO lecture/création/modification)</field>
            <field name="model_id" ref="project.model_project_project"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_pmo'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="project_task_rule_pmo" model="ir.rule">
            <field name="name">Tâches : tous (PMO lecture/création/modification)</field>
            <field name="model_id" ref="project.model_project_task"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_pmo'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- PMO : Feuilles de temps (lecture et validation = write, pas de création/suppression) -->
        <record id="account_analytic_line_rule_pmo" model="ir.rule">
            <field name="name">Feuilles de temps : tous (PMO lecture et validation)</field>
            <field name="model_id" ref="analytic.model_account_analytic_line"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_pmo'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- PMO : CRM, Helpdesk, Reporting (lecture seule) -->
        <record id="crm_lead_rule_pmo" model="ir.rule">
            <field name="name">CRM opportunités : tous (PMO lecture seule)</field>
            <field name="model_id" ref="crm.model_crm_lead"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_pmo'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="helpdesk_ticket_rule_pmo" model="ir.rule">
            <field name="name">Tickets Helpdesk : tous (PMO lecture seule)</field>
            <field name="model_id" ref="helpdesk.model_helpdesk_ticket"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_pmo'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="project_task_burndown_report_rule_pmo" model="ir.rule">
            <field name="name">Reporting projet : tous (PMO lecture seule)</field>
            <field name="model_id" ref="project.model_project_task_burndown_chart_report"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_pmo'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- BD MANAGER : CRM, Devis, Clients (lecture, création, modification, pas de suppression) -->
        <record id="crm_lead_rule_bd_manager" model="ir.rule">
            <field name="name">CRM / Leads / Opportunités : tous (BD MANAGER)</field>
            <field name="model_id" ref="crm.model_crm_lead"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_bd_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="sale_order_rule_bd_manager" model="ir.rule">
            <field name="name">Devis : tous (BD MANAGER)</field>
            <field name="model_id" ref="sale.model_sale_order"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_bd_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="sale_order_line_rule_bd_manager" model="ir.rule">
            <field name="name">Lignes de devis : tous (BD MANAGER)</field>
            <field name="model_id" ref="sale.model_sale_order_line"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_bd_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="res_partner_rule_bd_manager" model="ir.rule">
            <field name="name">Clients / Contacts : tous (BD MANAGER)</field>
            <field name="model_id" ref="base.model_res_partner"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_bd_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- SI7A AGENT : Leads / Opportunités assignés, Clients lecture limitée (lecture seule) -->
        <record id="crm_lead_rule_siha_agent" model="ir.rule">
            <field name="name">Leads / Opportunités : assignés à l'utilisateur (SI7A AGENT)</field>
            <field name="model_id" ref="crm.model_crm_lead"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_siha_agent'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="res_partner_rule_siha_agent" model="ir.rule">
            <field name="name">Clients : lecture limitée (SI7A AGENT)</field>
            <field name="model_id" ref="base.model_res_partner"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_siha_agent'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- DF MANAGER : Projets, Tâches, Produits, Roadmap (milestones) : lecture, création, modification (sans suppression) -->
        <record id="project_project_rule_df_manager" model="ir.rule">
            <field name="name">Projets : tous (DF MANAGER)</field>
            <field name="model_id" ref="project.model_project_project"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_df_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="project_task_rule_df_manager" model="ir.rule">
            <field name="name">Tâches : tous (DF MANAGER)</field>
            <field name="model_id" ref="project.model_project_task"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_df_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="product_template_rule_df_manager" model="ir.rule">
            <field name="name">Produits (template) : tous (DF MANAGER)</field>
            <field name="model_id" ref="product.model_product_template"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_df_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="product_product_rule_df_manager" model="ir.rule">
            <field name="name">Produits (variantes) : tous (DF MANAGER)</field>
            <field name="model_id" ref="product.model_product_product"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_df_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="project_milestone_rule_df_manager" model="ir.rule">
            <field name="name">Roadmap (milestones) : tous (DF MANAGER)</field>
            <field name="model_id" ref="project.model_project_milestone"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_df_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <!-- DF MANAGER : Helpdesk N3 (lecture seule) -->
        <record id="helpdesk_ticket_rule_df_manager" model="ir.rule">
            <field name="name">Helpdesk N3 : tous (DF MANAGER lecture seule)</field>
            <field name="model_id" ref="helpdesk.model_helpdesk_ticket"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_df_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <record id="helpdesk_team_rule_df_manager" model="ir.rule">
            <field name="name">Équipes Helpdesk N3 : tous (DF MANAGER lecture seule)</field>
            <field name="model_id" ref="helpdesk.model_helpdesk_team"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('access_management.group_df_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
    </data>
</odoo>

